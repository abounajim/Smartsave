<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SmartSave - AI-Powered Savings Coach</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700;800&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Poppins', sans-serif; background: #0f172a; }
        .glass { background: rgba(255, 255, 255, 0.05); backdrop-filter: blur(10px); border: 1px solid rgba(255, 255, 255, 0.1); }
        .gradient-text { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); -webkit-background-clip: text; -webkit-text-fill-color: transparent; }
        .card-hover { transition: all 0.3s ease; }
        .card-hover:hover { transform: translateY(-5px); box-shadow: 0 20px 40px rgba(0,0,0,0.3); }
        .streak-flame { animation: flicker 1.5s infinite alternate; }
        @keyframes flicker { 0% { opacity: 1; transform: scale(1); } 100% { opacity: 0.8; transform: scale(1.1); } }
        .slide-in { animation: slideIn 0.5s ease-out; }
        @keyframes slideIn { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }
        .pulse-glow { animation: pulseGlow 2s infinite; }
        @keyframes pulseGlow { 0%, 100% { box-shadow: 0 0 20px rgba(99, 102, 241, 0.5); } 50% { box-shadow: 0 0 40px rgba(99, 102, 241, 0.8); } }
        .confetti { position: fixed; width: 10px; height: 10px; background: #f0f; animation: confetti-fall 3s linear forwards; z-index: 9999; }
        @keyframes confetti-fall { to { transform: translateY(100vh) rotate(360deg); opacity: 0; } }
        .bank-card { transition: all 0.3s ease; cursor: pointer; }
        .bank-card:hover { transform: scale(1.05); border-color: rgba(99, 102, 241, 0.5); }
        .sync-spinner { animation: spin 1s linear infinite; }
        @keyframes spin { from { transform: rotate(0deg); } to { transform: rotate(360deg); } }
        .fade-out { animation: fadeOut 0.5s ease-out forwards; }
        @keyframes fadeOut { to { opacity: 0; visibility: hidden; } }
        .demo-bg { filter: blur(2px) brightness(0.4); pointer-events: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; overflow-y: auto; z-index: 0; }
        .empty-state { text-align: center; padding: 3rem 1rem; color: #6b7280; }
        .empty-state i { font-size: 3rem; margin-bottom: 1rem; opacity: 0.5; }
        input[type="date"]::-webkit-calendar-picker-indicator { filter: invert(1); cursor: pointer; }
        
        /* Profile dropdown fix */
        .profile-menu-container { position: relative; }
        .profile-dropdown {
            position: absolute;
            right: 0;
            top: calc(100% + 0.5rem);
            width: 12rem;
            opacity: 0;
            visibility: hidden;
            transform: translateY(-10px);
            transition: all 0.2s ease;
            z-index: 50;
        }
        .profile-menu-container:hover .profile-dropdown,
        .profile-dropdown:hover {
            opacity: 1;
            visibility: visible;
            transform: translateY(0);
        }
        .profile-menu-container::after {
            content: '';
            position: absolute;
            top: 100%;
            left: 0;
            right: 0;
            height: 0.5rem;
            background: transparent;
        }
        
        /* Alert animations */
        .alert-breach { animation: alertPulse 1s infinite; border-color: rgba(239, 68, 68, 0.8) !important; }
        @keyframes alertPulse { 0%, 100% { box-shadow: 0 0 20px rgba(239, 68, 68, 0.5); } 50% { box-shadow: 0 0 40px rgba(239, 68, 68, 0.8); } }
        
        .progress-bar-striped {
            background-image: linear-gradient(45deg,rgba(255,255,255,.15) 25%,transparent 25%,transparent 50%,rgba(255,255,255,.15) 50%,rgba(255,255,255,.15) 75%,transparent 75%,transparent);
            background-size: 1rem 1rem;
            animation: progress-bar-stripes 1s linear infinite;
        }
        @keyframes progress-bar-stripes { 0% { background-position: 1rem 0; } 100% { background-position: 0 0; } }
        
        .smart-advice-card { border-left: 4px solid #10b981; }
        .smart-warning-card { border-left: 4px solid #f59e0b; }
        .smart-danger-card { border-left: 4px solid #ef4444; }
    </style>
</head>
<body class="text-white min-h-screen overflow-x-hidden">

    <!-- Confetti Container -->
    <div id="confetti-container"></div>

    <!-- DEMO BACKGROUND -->
    <div id="demo-background" class="demo-bg">
        <div class="pt-24 pb-12 px-4 sm:px-6 lg:px-8 max-w-7xl mx-auto opacity-50">
            <div class="mb-8">
                <h1 class="text-4xl md:text-5xl font-bold mb-2">Welcome back, <span class="gradient-text">Demo User</span>! üéØ</h1>
                <p class="text-gray-400 text-lg">Your AI coach has saved you <span class="text-green-400 font-bold">$245</span> this month</p>
            </div>
        </div>
    </div>

    <!-- Auth Modal -->
    <div id="auth-modal" class="fixed inset-0 z-[60] flex items-center justify-center p-4 bg-slate-900/90 backdrop-blur-sm">
        <div class="w-full max-w-4xl grid md:grid-cols-2 gap-8 items-center relative z-10">
            <div class="text-center md:text-left">
                <div class="w-20 h-20 rounded-2xl bg-gradient-to-br from-indigo-500 to-purple-600 flex items-center justify-center mx-auto md:mx-0 mb-6 floating">
                    <i class="fas fa-piggy-bank text-4xl"></i>
                </div>
                <h1 class="text-5xl font-bold mb-4 gradient-text">SmartSave AI</h1>
                <p class="text-xl text-gray-300 mb-6">Your intelligent financial companion with smart budget alerts and daily spending guidance.</p>
            </div>
            
            <div class="glass rounded-3xl p-8 border border-gray-700 shadow-2xl bg-slate-900/80">
                <div class="flex gap-4 mb-6">
                    <button onclick="switchAuthMode('login')" id="tab-login" class="flex-1 py-2 rounded-xl bg-indigo-600 text-white font-semibold transition-all">Login</button>
                    <button onclick="switchAuthMode('register')" id="tab-register" class="flex-1 py-2 rounded-xl bg-gray-800 text-gray-400 font-semibold transition-all">Sign Up</button>
                </div>

                <form id="auth-form" class="space-y-4">
                    <div id="name-field" class="hidden">
                        <label class="block text-sm text-gray-400 mb-2">Full Name</label>
                        <input type="text" id="user-name" class="w-full bg-gray-800/50 border border-gray-700 rounded-xl px-4 py-3 focus:outline-none focus:border-indigo-500 transition-colors" placeholder="John Doe">
                    </div>
                    <div>
                        <label class="block text-sm text-gray-400 mb-2">Email Address</label>
                        <input type="email" id="user-email" class="w-full bg-gray-800/50 border border-gray-700 rounded-xl px-4 py-3 focus:outline-none focus:border-indigo-500 transition-colors" placeholder="john@example.com" required>
                    </div>
                    <div>
                        <label class="block text-sm text-gray-400 mb-2">Password</label>
                        <input type="password" id="user-password" class="w-full bg-gray-800/50 border border-gray-700 rounded-xl px-4 py-3 focus:outline-none focus:border-indigo-500 transition-colors" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" required>
                    </div>
                    <button type="submit" class="w-full py-3 bg-gradient-to-r from-indigo-500 to-purple-600 rounded-xl font-bold hover:shadow-lg hover:shadow-indigo-500/30 transition-all flex items-center justify-center gap-2">
                        <span id="auth-btn-text">Login</span>
                        <i class="fas fa-arrow-right"></i>
                    </button>
                </form>
            </div>
        </div>
    </div>

    <!-- Navigation -->
    <nav class="fixed top-0 w-full z-40 glass border-b border-gray-800 hidden" id="main-nav">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex items-center justify-between h-16">
                <div class="flex items-center gap-3">
                    <div class="w-10 h-10 rounded-xl bg-gradient-to-br from-indigo-500 to-purple-600 flex items-center justify-center">
                        <i class="fas fa-piggy-bank text-xl"></i>
                    </div>
                    <span class="text-xl font-bold gradient-text">SmartSave AI</span>
                </div>
                <div class="flex items-center gap-6">
                    <div class="hidden md:flex items-center gap-2 px-4 py-2 rounded-full bg-orange-500/20 border border-orange-500/30">
                        <i class="fas fa-fire text-orange-500 streak-flame"></i>
                        <span class="font-bold text-orange-400" id="streak-display">0 Day Streak</span>
                    </div>
                    <div class="flex items-center gap-3">
                        <button onclick="openBankModal()" class="hidden sm:flex items-center gap-2 px-4 py-2 rounded-full bg-emerald-500/20 border border-emerald-500/30 text-emerald-400 hover:bg-emerald-500/30 transition-all">
                            <i class="fas fa-plus"></i> Add Bank
                        </button>
                        
                        <div class="profile-menu-container">
                            <button class="w-10 h-10 rounded-full bg-gradient-to-r from-pink-500 to-rose-500 flex items-center justify-center hover:scale-110 transition-transform">
                                <span id="user-initial" class="font-bold">U</span>
                            </button>
                            <div class="profile-dropdown glass rounded-xl border border-gray-700 p-2 bg-slate-900">
                                <button onclick="openBudgetModal()" class="w-full text-left px-4 py-2 rounded-lg hover:bg-gray-800 text-white flex items-center gap-2 mb-1">
                                    <i class="fas fa-wallet text-blue-400"></i> Set Budget
                                </button>
                                <button onclick="openSavingsGoalModal()" class="w-full text-left px-4 py-2 rounded-lg hover:bg-gray-800 text-white flex items-center gap-2 mb-1">
                                    <i class="fas fa-piggy-bank text-emerald-400"></i> Set Savings Goal
                                </button>
                                <button onclick="logout()" class="w-full text-left px-4 py-2 rounded-lg hover:bg-gray-800 text-red-400 flex items-center gap-2">
                                    <i class="fas fa-sign-out-alt"></i> Logout
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </nav>

    <!-- Budget Modal -->
    <div id="budget-modal" class="fixed inset-0 z-50 hidden">
        <div class="absolute inset-0 bg-black/80 backdrop-blur-sm" onclick="closeBudgetModal()"></div>
        <div class="absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-full max-w-md p-6 glass rounded-2xl border border-gray-700 bg-slate-900">
            <h3 class="text-2xl font-bold mb-2">Set Monthly Budget</h3>
            <p class="text-gray-400 mb-4">I'll alert you at 80% and warn you if you breach it</p>
            <div class="space-y-4">
                <div>
                    <label class="block text-sm text-gray-400 mb-2">Monthly Budget ($)</label>
                    <input type="number" id="budget-input" class="w-full bg-gray-800 border border-gray-700 rounded-xl px-4 py-3 focus:outline-none focus:border-indigo-500" placeholder="2000" min="1">
                </div>
                <div class="flex gap-3 pt-2">
                    <button onclick="closeBudgetModal()" class="flex-1 py-3 rounded-xl border border-gray-600 hover:bg-gray-800 transition-all">Cancel</button>
                    <button onclick="setBudget()" class="flex-1 py-3 bg-gradient-to-r from-indigo-500 to-purple-600 rounded-xl font-bold hover:shadow-lg transition-all">Set Budget</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Savings Goal Modal -->
    <div id="savings-goal-modal" class="fixed inset-0 z-50 hidden">
        <div class="absolute inset-0 bg-black/80 backdrop-blur-sm" onclick="closeSavingsGoalModal()"></div>
        <div class="absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-full max-w-md p-6 glass rounded-2xl border border-gray-700 bg-slate-900">
            <h3 class="text-2xl font-bold mb-2">Set Savings Target</h3>
            <p class="text-gray-400 mb-4">Your daily spending limit will be calculated from this</p>
            <div class="space-y-4">
                <div>
                    <label class="block text-sm text-gray-400 mb-2">Target Savings ($)</label>
                    <input type="number" id="savings-goal-input" class="w-full bg-gray-800 border border-gray-700 rounded-xl px-4 py-3 focus:outline-none focus:border-indigo-500" placeholder="500" min="1">
                </div>
                <div>
                    <label class="block text-sm text-gray-400 mb-2">By End of Month</label>
                    <input type="date" id="savings-date-input" class="w-full bg-gray-800 border border-gray-700 rounded-xl px-4 py-3 focus:outline-none focus:border-indigo-500">
                </div>
                <div class="flex gap-3 pt-2">
                    <button onclick="closeSavingsGoalModal()" class="flex-1 py-3 rounded-xl border border-gray-600 hover:bg-gray-800 transition-all">Cancel</button>
                    <button onclick="setSavingsGoal()" class="flex-1 py-3 bg-gradient-to-r from-emerald-500 to-teal-600 rounded-xl font-bold hover:shadow-lg transition-all">Set Goal</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Bank Modal -->
    <div id="bank-modal" class="fixed inset-0 z-50 hidden">
        <div class="absolute inset-0 bg-black/80 backdrop-blur-sm" onclick="closeBankModal()"></div>
        <div class="absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-full max-w-2xl p-6 glass rounded-3xl border border-gray-700 max-h-[90vh] overflow-y-auto bg-slate-900">
            <div class="flex justify-between items-center mb-6">
                <h3 class="text-2xl font-bold">Connect Your Bank</h3>
                <button onclick="closeBankModal()" class="w-10 h-10 rounded-full bg-gray-800 hover:bg-gray-700 flex items-center justify-center">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div id="bank-selection" class="grid grid-cols-2 md:grid-cols-3 gap-4">
                <div onclick="selectBank('Chase')" class="bank-card glass p-4 rounded-2xl border border-gray-700 flex flex-col items-center gap-3 hover:bg-gray-800">
                    <div class="w-16 h-16 rounded-full bg-blue-600 flex items-center justify-center text-2xl font-bold">C</div>
                    <span class="font-semibold">Chase</span>
                </div>
                <div onclick="selectBank('Bank of America')" class="bank-card glass p-4 rounded-2xl border border-gray-700 flex flex-col items-center gap-3 hover:bg-gray-800">
                    <div class="w-16 h-16 rounded-full bg-red-600 flex items-center justify-center text-2xl font-bold">B</div>
                    <span class="font-semibold">Bank of America</span>
                </div>
                <div onclick="selectBank('Wells Fargo')" class="bank-card glass p-4 rounded-2xl border border-gray-700 flex flex-col items-center gap-3 hover:bg-gray-800">
                    <div class="w-16 h-16 rounded-full bg-yellow-600 flex items-center justify-center text-2xl font-bold">W</div>
                    <span class="font-semibold">Wells Fargo</span>
                </div>
            </div>
        </div>
    </div>

    <!-- Main Content -->
    <main class="pt-24 pb-12 px-4 sm:px-6 lg:px-8 max-w-7xl mx-auto hidden" id="main-content">
        
        <!-- Smart Alert Banner -->
        <div id="smart-alert-banner" class="hidden mb-6 glass rounded-2xl p-4 border-l-4 slide-in">
            <div class="flex items-start gap-3">
                <i id="alert-icon" class="fas fa-exclamation-triangle text-2xl mt-1"></i>
                <div class="flex-1">
                    <h4 id="alert-title" class="font-bold text-lg mb-1">Smart Alert</h4>
                    <p id="alert-message" class="text-sm text-gray-300 mb-2">Message here</p>
                    <p id="alert-advice" class="text-xs text-emerald-400 font-semibold">Advice here</p>
                </div>
                <button onclick="dismissAlert()" class="text-gray-500 hover:text-white"><i class="fas fa-times"></i></button>
            </div>
        </div>

        <!-- Daily Limit Card -->
        <div id="daily-limit-card" class="hidden mb-6 glass rounded-2xl p-4 border border-indigo-500/30 bg-indigo-900/10 slide-in">
            <div class="flex items-center justify-between">
                <div class="flex items-center gap-3">
                    <div class="w-12 h-12 rounded-xl bg-indigo-500/20 flex items-center justify-center">
                        <i class="fas fa-calculator text-indigo-400 text-xl"></i>
                    </div>
                    <div>
                        <p class="text-sm text-gray-400">Daily Spending Limit</p>
                        <h3 class="text-2xl font-bold text-indigo-400" id="daily-limit-amount">$0</h3>
                        <p class="text-xs text-gray-500" id="days-remaining">to reach your goal</p>
                    </div>
                </div>
                <div class="text-right">
                    <p class="text-sm text-gray-400">Spent Today</p>
                    <h3 class="text-2xl font-bold" id="spent-today">$0</h3>
                    <p class="text-xs" id="daily-status">On track</p>
                </div>
            </div>
        </div>

        <!-- Welcome -->
        <div class="mb-8 text-center slide-in">
            <h1 class="text-4xl md:text-5xl font-bold mb-2">Welcome, <span class="gradient-text" id="display-name">Saver</span>! üéâ</h1>
            <p class="text-gray-400 text-lg" id="smart-subtitle">Start by setting your budget and savings goal</p>
        </div>

        <!-- Stats Grid -->
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
            <!-- Total Savings with Chart -->
            <div class="glass rounded-2xl p-6 card-hover relative overflow-hidden lg:col-span-2">
                <div class="flex justify-between items-start mb-4">
                    <div>
                        <p class="text-gray-400 text-sm mb-1">Total Savings</p>
                        <h3 class="text-3xl font-bold text-emerald-400" id="total-savings">$0</h3>
                        <p class="text-sm mt-1" id="savings-goal-text">Goal: Not set</p>
                    </div>
                    <div class="w-12 h-12 rounded-xl bg-emerald-500/20 flex items-center justify-center">
                        <i class="fas fa-piggy-bank text-emerald-400 text-xl"></i>
                    </div>
                </div>
                
                <!-- Mini Savings Chart -->
                <div class="h-24 mt-4" id="savings-chart-container">
                    <div class="empty-state h-full flex items-center justify-center">
                        <p class="text-xs text-gray-500">Set a savings goal to see progress</p>
                    </div>
                </div>
            </div>

            <!-- Budget -->
            <div class="glass rounded-2xl p-6 card-hover relative overflow-hidden cursor-pointer" onclick="openBudgetModal()" id="budget-card">
                <div class="flex justify-between items-start mb-4">
                    <div>
                        <p class="text-gray-400 text-sm mb-1">Monthly Budget</p>
                        <h3 class="text-3xl font-bold text-blue-400" id="monthly-budget">Set Budget</h3>
                    </div>
                    <div class="w-12 h-12 rounded-xl bg-blue-500/20 flex items-center justify-center">
                        <i class="fas fa-calendar-alt text-blue-400 text-xl"></i>
                    </div>
                </div>
                <div class="w-full bg-gray-700 rounded-full h-3 mt-2 overflow-hidden">
                    <div class="bg-gray-600 h-3 rounded-full transition-all duration-500" style="width: 0%" id="budget-progress"></div>
                </div>
                <p class="text-xs text-gray-400 mt-2" id="budget-text">Click to set budget</p>
            </div>

            <!-- Streak -->
            <div class="glass rounded-2xl p-6 card-hover relative overflow-hidden">
                <div class="flex justify-between items-start mb-4">
                    <div>
                        <p class="text-gray-400 text-sm mb-1">Current Streak</p>
                        <h3 class="text-3xl font-bold text-orange-400 flex items-center gap-2">
                            <span id="streak-count">0</span>
                            <i class="fas fa-fire text-2xl opacity-30"></i>
                        </h3>
                    </div>
                    <div class="w-12 h-12 rounded-xl bg-orange-500/20 flex items-center justify-center">
                        <i class="fas fa-trophy text-orange-400 text-xl"></i>
                    </div>
                </div>
                <p class="text-sm text-gray-400">Keep logging daily!</p>
            </div>
        </div>

        <!-- Smart Insights -->
        <div class="mb-8 glass rounded-2xl p-6 border border-indigo-500/30 slide-in" id="smart-insights">
            <h3 class="text-xl font-bold mb-4 flex items-center gap-2">
                <i class="fas fa-brain text-indigo-400"></i>
                Smart Insights
            </h3>
            <div id="insights-container" class="space-y-3">
                <div class="p-4 rounded-lg bg-indigo-500/10 border border-indigo-500/20">
                    <p class="text-sm text-gray-300">Set your budget and savings goal to get personalized daily spending limits and smart alerts.</p>
                </div>
            </div>
        </div>

        <!-- Dashboard Grid -->
        <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
            
            <!-- Left Column -->
            <div class="lg:col-span-2 space-y-8">
                
                <!-- Analytics -->
                <div class="glass rounded-2xl p-6 slide-in min-h-[400px] flex flex-col">
                    <div class="flex justify-between items-center mb-6">
                        <h3 class="text-xl font-bold flex items-center gap-2">
                            <i class="fas fa-chart-pie text-indigo-400"></i>
                            Spending Analytics
                        </h3>
                    </div>
                    
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6 flex-1">
                        <div class="relative h-64" id="chart-wrapper">
                            <div id="chart-container" class="h-full flex items-center justify-center">
                                <div class="empty-state text-center">
                                    <i class="fas fa-chart-pie text-4xl text-gray-600 mb-3"></i>
                                    <h4 class="text-lg font-semibold text-gray-400 mb-2">No data yet</h4>
                                    <p class="text-sm text-gray-500 mb-4">Add transactions to see analytics</p>
                                </div>
                            </div>
                        </div>
                        
                        <div class="space-y-4" id="category-breakdown">
                            <div class="empty-state text-center h-full flex flex-col items-center justify-center">
                                <i class="fas fa-list text-4xl text-gray-600 mb-3"></i>
                                <p class="text-sm text-gray-500">Categories will appear here</p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Goals -->
                <div class="glass rounded-2xl p-6 slide-in">
                    <div class="flex justify-between items-center mb-6">
                        <h3 class="text-xl font-bold flex items-center gap-2">
                            <i class="fas fa-bullseye text-pink-400"></i>
                            Savings Goals
                        </h3>
                    </div>
                    <div id="goals-container" class="space-y-4">
                        <div class="empty-state py-8">
                            <i class="fas fa-bullseye text-gray-600"></i>
                            <p class="text-sm text-gray-500">No goals yet</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Right Column -->
            <div class="space-y-8">
                
                <!-- Quick Add -->
                <div class="glass rounded-2xl p-6 slide-in">
                    <h3 class="text-xl font-bold mb-4 flex items-center gap-2">
                        <i class="fas fa-plus-circle text-emerald-400"></i>
                        Quick Add
                    </h3>
                    <div class="space-y-4">
                        <div>
                            <label class="block text-sm text-gray-400 mb-2">Amount</label>
                            <div class="relative">
                                <span class="absolute left-3 top-1/2 -translate-y-1/2 text-gray-400">$</span>
                                <input type="number" id="transaction-amount" class="w-full bg-gray-800 border border-gray-700 rounded-xl px-8 py-3 focus:outline-none focus:border-emerald-500 transition-colors" placeholder="0.00" step="0.01">
                            </div>
                        </div>
                        
                        <div>
                            <label class="block text-sm text-gray-400 mb-2">Date</label>
                            <input type="date" id="transaction-date" class="w-full bg-gray-800 border border-gray-700 rounded-xl px-4 py-3 focus:outline-none focus:border-emerald-500 transition-colors text-white">
                        </div>
                        
                        <div>
                            <label class="block text-sm text-gray-400 mb-2">Category</label>
                            <select id="transaction-category" class="w-full bg-gray-800 border border-gray-700 rounded-xl px-4 py-3 focus:outline-none focus:border-emerald-500 transition-colors">
                                <option value="food">üçî Food & Dining</option>
                                <option value="shopping">üõçÔ∏è Shopping</option>
                                <option value="transport">üöó Transport</option>
                                <option value="entertainment">üé¨ Entertainment</option>
                                <option value="bills">üí° Bills</option>
                                <option value="income">üí∞ Income</option>
                            </select>
                        </div>
                        
                        <div>
                            <label class="block text-sm text-gray-400 mb-2">Type</label>
                            <div class="grid grid-cols-2 gap-2">
                                <button onclick="setTransactionType('expense')" id="btn-expense" class="py-2 rounded-lg bg-rose-500/20 border border-rose-500 text-rose-400 font-semibold transition-all">Expense</button>
                                <button onclick="setTransactionType('income')" id="btn-income" class="py-2 rounded-lg bg-gray-800 border border-gray-700 text-gray-400 font-semibold transition-all">Income</button>
                            </div>
                        </div>
                        
                        <button onclick="addTransaction()" class="w-full py-3 bg-gradient-to-r from-emerald-500 to-teal-600 rounded-xl font-bold hover:shadow-lg hover:shadow-emerald-500/30 transition-all flex items-center justify-center gap-2">
                            <i class="fas fa-check"></i> Add Transaction
                        </button>
                    </div>
                </div>

                <!-- Activity -->
                <div class="glass rounded-2xl p-6 slide-in">
                    <h3 class="text-xl font-bold mb-4 flex items-center gap-2">
                        <i class="fas fa-history text-blue-400"></i>
                        Recent Activity
                    </h3>
                    <div id="recent-activity" class="space-y-3">
                        <div class="empty-state py-8">
                            <i class="fas fa-receipt text-gray-600"></i>
                            <p class="text-sm text-gray-500">No transactions yet</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- Notification -->
    <div id="notification" class="fixed bottom-4 right-4 z-50 hidden">
        <div class="glass rounded-xl p-4 border border-emerald-500/30 flex items-center gap-3 notification bg-slate-900">
            <div class="w-10 h-10 rounded-full bg-emerald-500/20 flex items-center justify-center">
                <i class="fas fa-check text-emerald-400"></i>
            </div>
            <div>
                <p class="font-bold text-emerald-400" id="notif-title">Success!</p>
                <p class="text-sm text-gray-300" id="notif-message">Done</p>
            </div>
        </div>
    </div>

    <script>
        // State
        let currentTransactionType = 'expense';
        let selectedIcon = '‚úàÔ∏è';
        let streakCount = 0;
        let savings = 0;
        let currentUser = null;
        let connectedBanks = [];
        let transactions = [];
        let goals = [];
        let spendingChart = null;
        let savingsChart = null;
        let monthlyBudget = 0;
        let budgetSpent = 0;
        let savingsGoal = { amount: 0, deadline: null, dailyLimit: 0 };
        let alertShown = { eighty: false, breached: false };

        function initDatePicker() {
            const today = new Date().toISOString().split('T')[0];
            const dateInput = document.getElementById('transaction-date');
            const savingsDateInput = document.getElementById('savings-date-input');
            
            if (dateInput) {
                dateInput.value = today;
                dateInput.max = today;
            }
            
            // Set savings date to end of current month
            if (savingsDateInput) {
                const lastDay = new Date();
                lastDay.setMonth(lastDay.getMonth() + 1);
                lastDay.setDate(0);
                savingsDateInput.value = lastDay.toISOString().split('T')[0];
                savingsDateInput.min = today;
            }
        }

        // Budget Functions
        function openBudgetModal() {
            document.getElementById('budget-modal').classList.remove('hidden');
            document.getElementById('budget-input').focus();
        }

        function closeBudgetModal() {
            document.getElementById('budget-modal').classList.add('hidden');
        }

        function setBudget() {
            const amount = parseFloat(document.getElementById('budget-input').value);
            if (!amount || amount <= 0) {
                showNotification('Error', 'Please enter a valid budget amount', 'error');
                return;
            }
            
            monthlyBudget = amount;
            updateBudgetDisplay();
            calculateDailyLimit();
            closeBudgetModal();
            showNotification('Budget Set', `Monthly budget: $${monthlyBudget.toLocaleString()}`, 'success');
            generateSmartInsights();
        }

        // Savings Goal Functions
        function openSavingsGoalModal() {
            document.getElementById('savings-goal-modal').classList.remove('hidden');
            document.getElementById('savings-goal-input').focus();
        }

        function closeSavingsGoalModal() {
            document.getElementById('savings-goal-modal').classList.add('hidden');
        }

        function setSavingsGoal() {
            const amount = parseFloat(document.getElementById('savings-goal-input').value);
            const deadline = document.getElementById('savings-date-input').value;
            
            if (!amount || amount <= 0) {
                showNotification('Error', 'Please enter a valid savings goal', 'error');
                return;
            }
            
            savingsGoal = { amount, deadline, dailyLimit: 0 };
            calculateDailyLimit();
            updateSavingsDisplay();
            closeSavingsGoalModal();
            showNotification('Goal Set', `Save $${amount.toLocaleString()} by ${new Date(deadline).toLocaleDateString()}`, 'success');
            generateSmartInsights();
        }

        function calculateDailyLimit() {
            if (!savingsGoal.amount || !savingsGoal.deadline || monthlyBudget <= 0) {
                document.getElementById('daily-limit-card').classList.add('hidden');
                return;
            }
            
            const today = new Date();
            const deadline = new Date(savingsGoal.deadline);
            const daysLeft = Math.max(1, Math.ceil((deadline - today) / (1000 * 60 * 60 * 24)));
            
            // Daily spending limit = (Monthly Budget - Savings Goal) / Days left in month
            const daysInMonth = new Date(today.getFullYear(), today.getMonth() + 1, 0).getDate();
            const daysRemaining = Math.max(1, daysInMonth - today.getDate() + 1);
            
            // Must save this much per day
            const dailySavingsRequired = savingsGoal.amount / daysLeft;
            
            // Can spend this much per day
            const dailySpendLimit = Math.max(0, (monthlyBudget - budgetSpent) / daysRemaining - dailySavingsRequired);
            
            savingsGoal.dailyLimit = dailySpendLimit;
            
            // Show daily limit card
            document.getElementById('daily-limit-card').classList.remove('hidden');
            document.getElementById('daily-limit-amount').textContent = `$${dailySpendLimit.toFixed(0)}`;
            document.getElementById('days-remaining').textContent = `${daysLeft} days to save $${savingsGoal.amount.toLocaleString()}`;
            
            updateDailySpending();
        }

        function updateDailySpending() {
            const today = new Date().toDateString();
            const spentToday = transactions
                .filter(t => t.type === 'expense' && new Date(t.date).toDateString() === today)
                .reduce((sum, t) => sum + t.amount, 0);
            
            document.getElementById('spent-today').textContent = `$${spentToday.toFixed(2)}`;
            
            const statusEl = document.getElementById('daily-status');
            if (savingsGoal.dailyLimit > 0) {
                const percent = (spentToday / savingsGoal.dailyLimit) * 100;
                if (percent > 100) {
                    statusEl.textContent = '‚ö†Ô∏è Over limit!';
                    statusEl.className = 'text-xs text-red-400 font-bold';
                } else if (percent > 80) {
                    statusEl.textContent = '‚ö° Approaching limit';
                    statusEl.className = 'text-xs text-yellow-400';
                } else {
                    statusEl.textContent = '‚úÖ On track';
                    statusEl.className = 'text-xs text-emerald-400';
                }
            }
        }

        // Smart Alert System
        function checkBudgetAlerts() {
            if (monthlyBudget <= 0) return;
            
            const percentUsed = (budgetSpent / monthlyBudget) * 100;
            const banner = document.getElementById('smart-alert-banner');
            const title = document.getElementById('alert-title');
            const message = document.getElementById('alert-message');
            const advice = document.getElementById('alert-advice');
            const icon = document.getElementById('alert-icon');
            
            // 80% Warning (show once)
            if (percentUsed >= 80 && percentUsed < 100 && !alertShown.eighty) {
                alertShown.eighty = true;
                banner.classList.remove('hidden', 'alert-breach');
                banner.classList.add('smart-warning-card');
                banner.style.borderLeftColor = '#f59e0b';
                icon.className = 'fas fa-exclamation-triangle text-2xl mt-1 text-yellow-400';
                title.textContent = '‚ö†Ô∏è Budget Alert: 80% Used';
                title.className = 'font-bold text-lg mb-1 text-yellow-400';
                message.textContent = `You've spent $${budgetSpent.toFixed(2)} of your $${monthlyBudget.toLocaleString()} monthly budget.`;
                advice.textContent = `Daily limit reduced to $${(savingsGoal.dailyLimit * 0.5).toFixed(0)}. Consider pausing non-essential spending.`;
                showNotification('Budget Warning', 'You\'ve reached 80% of your budget!', 'error');
            }
            
            // 100% Breach (show every time)
            if (percentUsed >= 100) {
                banner.classList.remove('hidden');
                banner.classList.add('alert-breach');
                banner.style.borderLeftColor = '#ef4444';
                icon.className = 'fas fa-ban text-2xl mt-1 text-red-400';
                title.textContent = 'üö® BUDGET BREACHED!';
                title.className = 'font-bold text-lg mb-1 text-red-400';
                message.textContent = `You've exceeded your $${monthlyBudget.toLocaleString()} budget by $${(budgetSpent - monthlyBudget).toFixed(2)}!`;
                
                const overspend = budgetSpent - monthlyBudget;
                const daysLeft = Math.max(1, new Date(savingsGoal.deadline || new Date().setMonth(new Date().getMonth() + 1)) - new Date()) / (1000 * 60 * 60 * 24);
                advice.textContent = `URGENT: Cut spending by $${(overspend / daysLeft + savingsGoal.dailyLimit).toFixed(0)}/day to recover. Avoid all non-essential purchases!`;
                
                if (!alertShown.breached) {
                    alertShown.breached = true;
                    showNotification('BUDGET BREACHED!', 'Stop spending immediately!', 'error');
                    createConfetti();
                }
            }
        }

        function dismissAlert() {
            document.getElementById('smart-alert-banner').classList.add('hidden');
        }

        // Generate Smart Insights
        function generateSmartInsights() {
            const container = document.getElementById('insights-container');
            const insights = [];
            
            if (monthlyBudget > 0 && savingsGoal.amount > 0) {
                const daysLeft = Math.max(1, Math.ceil((new Date(savingsGoal.deadline) - new Date()) / (1000 * 60 * 60 * 24)));
                const dailySave = savingsGoal.amount / daysLeft;
                const dailySpend = savingsGoal.dailyLimit;
                
                insights.push({
                    type: 'success',
                    icon: 'fa-lightbulb',
                    title: 'Smart Daily Plan',
                    text: `Save $${dailySave.toFixed(0)}/day and spend max $${dailySpend.toFixed(0)}/day to hit your goal.`
                });
                
                if (budgetSpent > monthlyBudget * 0.5) {
                    const pace = (budgetSpent / (new Date().getDate())) * 30;
                    if (pace > monthlyBudget) {
                        insights.push({
                            type: 'warning',
                            icon: 'fa-chart-line',
                            title: 'Spending Pace Alert',
                            text: `At this pace, you'll spend $${pace.toFixed(0)} this month. Cut back to stay under $${monthlyBudget}!`
                        });
                    }
                }
            } else if (monthlyBudget > 0) {
                insights.push({
                    type: 'info',
                    icon: 'fa-piggy-bank',
                    title: 'Pro Tip',
                    text: 'Set a savings goal to get a personalized daily spending limit and track your progress!'
                });
            }
            
            if (insights.length === 0) {
                insights.push({
                    type: 'info',
                    icon: 'fa-info-circle',
                    title: 'Get Started',
                    text: 'Set your monthly budget and savings goal to unlock smart spending insights and alerts.'
                });
            }
            
            container.innerHTML = insights.map(i => `
                <div class="p-3 rounded-lg ${i.type === 'warning' ? 'bg-yellow-500/10 border border-yellow-500/30' : i.type === 'success' ? 'bg-emerald-500/10 border border-emerald-500/30' : 'bg-indigo-500/10 border border-indigo-500/30'} flex items-start gap-3 slide-in">
                    <i class="fas ${i.icon} ${i.type === 'warning' ? 'text-yellow-400' : i.type === 'success' ? 'text-emerald-400' : 'text-indigo-400'} mt-1"></i>
                    <div>
                        <p class="font-semibold ${i.type === 'warning' ? 'text-yellow-200' : i.type === 'success' ? 'text-emerald-200' : 'text-indigo-200'}">${i.title}</p>
                        <p class="text-sm text-gray-300">${i.text}</p>
                    </div>
                </div>
            `).join('');
        }

        function updateBudgetDisplay() {
            const budgetEl = document.getElementById('monthly-budget');
            const progressEl = document.getElementById('budget-progress');
            const textEl = document.getElementById('budget-text');
            const card = document.getElementById('budget-card');
            
            if (monthlyBudget > 0) {
                budgetEl.textContent = `$${monthlyBudget.toLocaleString()}`;
                const percent = Math.min((budgetSpent / monthlyBudget) * 100, 100);
                progressEl.style.width = percent + '%';
                
                // Color coding
                if (percent >= 100) {
                    progressEl.className = 'h-3 rounded-full transition-all duration-500 bg-red-500 progress-bar-striped';
                    card.classList.add('alert-breach');
                } else if (percent >= 80) {
                    progressEl.className = 'h-3 rounded-full transition-all duration-500 bg-yellow-500';
                    card.classList.remove('alert-breach');
                } else {
                    progressEl.className = 'h-3 rounded-full transition-all duration-500 bg-blue-500';
                    card.classList.remove('alert-breach');
                }
                
                const remaining = monthlyBudget - budgetSpent;
                textEl.textContent = `$${budgetSpent.toLocaleString()} spent ‚Ä¢ $${remaining.toLocaleString()} left`;
                textEl.className = remaining < 0 ? 'text-xs text-red-400 font-bold' : 'text-xs text-gray-400';
            }
            
            checkBudgetAlerts();
        }

        function updateSavingsDisplay() {
            const savingsEl = document.getElementById('total-savings');
            const goalText = document.getElementById('savings-goal-text');
            
            savingsEl.textContent = `$${savings.toLocaleString()}`;
            
            if (savingsGoal.amount > 0) {
                const percent = Math.min((savings / savingsGoal.amount) * 100, 100);
                goalText.textContent = `Goal: $${savingsGoal.amount.toLocaleString()} (${percent.toFixed(0)}%)`;
                goalText.className = 'text-sm mt-1 ' + (percent >= 100 ? 'text-emerald-400 font-bold' : 'text-gray-400');
                
                // Update mini chart
                updateSavingsChart(percent);
            } else {
                goalText.textContent = 'Goal: Not set';
                goalText.className = 'text-sm mt-1 text-gray-500';
            }
        }

        function updateSavingsChart(percent) {
            const container = document.getElementById('savings-chart-container');
            
            if (savingsChart) {
                savingsChart.destroy();
            }
            
            container.innerHTML = '<canvas id="savingsChart"></canvas>';
            const ctx = document.getElementById('savingsChart').getContext('2d');
            
            savingsChart = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: ['Saved', 'Remaining'],
                    datasets: [{
                        data: [percent, 100 - percent],
                        backgroundColor: [
                            'rgba(16, 185, 129, 0.8)',
                            'rgba(75, 85, 99, 0.3)'
                        ],
                        borderWidth: 0,
                        borderRadius: 4
                    }]
                },
                options: {
                    indexAxis: 'y',
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: { display: false }
                    },
                    scales: {
                        x: { display: false, max: 100 },
                        y: { 
                            ticks: { color: '#9ca3af', font: { size: 10 } },
                            grid: { display: false }
                        }
                    }
                }
            });
        }

        // Auth
        function switchAuthMode(mode) {
            const loginTab = document.getElementById('tab-login');
            const registerTab = document.getElementById('tab-register');
            const nameField = document.getElementById('name-field');
            const btnText = document.getElementById('auth-btn-text');
            
            if (mode === 'login') {
                loginTab.className = 'flex-1 py-2 rounded-xl bg-indigo-600 text-white font-semibold transition-all';
                registerTab.className = 'flex-1 py-2 rounded-xl bg-gray-800 text-gray-400 font-semibold transition-all';
                nameField.classList.add('hidden');
                btnText.textContent = 'Login';
            } else {
                loginTab.className = 'flex-1 py-2 rounded-xl bg-gray-800 text-gray-400 font-semibold transition-all';
                registerTab.className = 'flex-1 py-2 rounded-xl bg-indigo-600 text-white font-semibold transition-all';
                nameField.classList.remove('hidden');
                btnText.textContent = 'Create Account';
            }
        }

        document.getElementById('auth-form').addEventListener('submit', function(e) {
            e.preventDefault();
            const email = document.getElementById('user-email').value;
            const name = document.getElementById('user-name').value || 'Saver';
            
            currentUser = { email, name, id: Date.now() };
            localStorage.setItem('smartsave_user', JSON.stringify(currentUser));
            
            document.getElementById('demo-background').style.display = 'none';
            document.getElementById('auth-modal').classList.add('fade-out');
            
            setTimeout(() => {
                document.getElementById('auth-modal').style.display = 'none';
                document.getElementById('main-content').classList.remove('hidden');
                document.getElementById('main-nav').classList.remove('hidden');
                document.getElementById('display-name').textContent = name;
                document.getElementById('user-initial').textContent = name[0].toUpperCase();
                
                initDatePicker();
                showNotification('Welcome!', `Your smart savings journey begins, ${name}!`, 'success');
            }, 500);
        });

        function logout() {
            localStorage.removeItem('smartsave_user');
            location.reload();
        }

        // Chart Functions
        function updateChartWithData() {
            const breakdown = {};
            transactions.forEach(t => {
                if (t.type === 'expense') {
                    breakdown[t.category] = (breakdown[t.category] || 0) + t.amount;
                }
            });
            
            if (Object.keys(breakdown).length === 0) return;
            
            const chartContainer = document.getElementById('chart-container');
            chartContainer.innerHTML = '<canvas id="spendingChart"></canvas>';
            
            const labels = Object.keys(breakdown).map(c => c.charAt(0).toUpperCase() + c.slice(1));
            const data = Object.values(breakdown);
            const colors = [
                'rgba(244, 63, 94, 0.8)',
                'rgba(59, 130, 246, 0.8)',
                'rgba(16, 185, 129, 0.8)',
                'rgba(139, 92, 246, 0.8)',
                'rgba(245, 158, 11, 0.8)'
            ];
            
            if (spendingChart) {
                spendingChart.destroy();
            }
            
            const ctx = document.getElementById('spendingChart').getContext('2d');
            spendingChart = new Chart(ctx, {
                type: 'doughnut',
                data: {
                    labels: labels,
                    datasets: [{
                        data: data,
                        backgroundColor: colors,
                        borderWidth: 0,
                        hoverOffset: 10
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'bottom',
                            labels: { color: '#9ca3af', padding: 15, usePointStyle: true, font: { size: 11 } }
                        }
                    },
                    cutout: '60%'
                }
            });
            
            updateCategoryBreakdown(breakdown);
        }

        function updateCategoryBreakdown(breakdownData) {
            const container = document.getElementById('category-breakdown');
            if (!container) return;
            
            const total = Object.values(breakdownData).reduce((a, b) => a + b, 0);
            
            const colors = {
                food: { color: 'rose', icon: 'fa-utensils', label: 'Food & Dining' },
                shopping: { color: 'blue', icon: 'fa-shopping-bag', label: 'Shopping' },
                transport: { color: 'emerald', icon: 'fa-bus', label: 'Transport' },
                entertainment: { color: 'purple', icon: 'fa-film', label: 'Entertainment' },
                bills: { color: 'yellow', icon: 'fa-bolt', label: 'Bills' },
                others: { color: 'gray', icon: 'fa-receipt', label: 'Others' }
            };
            
            container.innerHTML = Object.entries(breakdownData)
                .sort((a, b) => b[1] - a[1])
                .map(([cat, amount]) => {
                    const config = colors[cat] || colors.others;
                    const percent = total > 0 ? ((amount / total) * 100).toFixed(0) : 0;
                    return `
                        <div class="flex items-center justify-between p-3 rounded-xl bg-gray-800/50 slide-in">
                            <div class="flex items-center gap-3">
                                <div class="w-10 h-10 rounded-lg bg-${config.color}-500/20 flex items-center justify-center">
                                    <i class="fas ${config.icon} text-${config.color}-400"></i>
                                </div>
                                <div>
                                    <p class="font-semibold text-sm">${config.label}</p>
                                    <p class="text-xs text-gray-400">${percent}% of spending</p>
                                </div>
                            </div>
                            <span class="font-bold text-${config.color}-400">$${amount.toFixed(0)}</span>
                        </div>
                    `;
                }).join('');
        }

        // Bank Functions
        function openBankModal() {
            document.getElementById('bank-modal').classList.remove('hidden');
        }

        function closeBankModal() {
            document.getElementById('bank-modal').classList.add('hidden');
        }

        function selectBank(bankName) {
            // Simulate connection
            setTimeout(() => {
                const balance = Math.floor(Math.random() * 5000) + 1000;
                savings += balance;
                updateSavingsDisplay();
                
                showNotification('Bank Connected!', `${bankName}: $${balance.toLocaleString()}`, 'success');
                closeBankModal();
                createConfetti();
            }, 1000);
        }

        function createConfetti() {
            const colors = ['#f43f5e', '#8b5cf6', '#10b981', '#f59e0b', '#3b82f6'];
            for (let i = 0; i < 30; i++) {
                setTimeout(() => {
                    const confetti = document.createElement('div');
                    confetti.className = 'confetti';
                    confetti.style.left = Math.random() * 100 + 'vw';
                    confetti.style.backgroundColor = colors[Math.floor(Math.random() * colors.length)];
                    confetti.style.animationDuration = (Math.random() * 2 + 2) + 's';
                    document.getElementById('confetti-container').appendChild(confetti);
                    setTimeout(() => confetti.remove(), 4000);
                }, i * 30);
            }
        }

        // Transaction Functions
        function setTransactionType(type) {
            currentTransactionType = type;
            const expenseBtn = document.getElementById('btn-expense');
            const incomeBtn = document.getElementById('btn-income');
            
            if (type === 'expense') {
                expenseBtn.className = 'py-2 rounded-lg bg-rose-500/20 border border-rose-500 text-rose-400 font-semibold transition-all';
                incomeBtn.className = 'py-2 rounded-lg bg-gray-800 border border-gray-700 text-gray-400 font-semibold transition-all';
            } else {
                expenseBtn.className = 'py-2 rounded-lg bg-gray-800 border border-gray-700 text-gray-400 font-semibold transition-all';
                incomeBtn.className = 'py-2 rounded-lg bg-emerald-500/20 border border-emerald-500 text-emerald-400 font-semibold transition-all';
            }
        }

        function addTransaction() {
            const amount = parseFloat(document.getElementById('transaction-amount').value);
            const category = document.getElementById('transaction-category').value;
            const dateInput = document.getElementById('transaction-date').value;
            
            if (!amount || amount <= 0) {
                showNotification('Error', 'Please enter a valid amount', 'error');
                return;
            }

            const isIncome = currentTransactionType === 'income';
            const merchant = isIncome ? 'Manual Income' : `${category.charAt(0).toUpperCase() + category.slice(1)} Expense`;
            const transactionDate = dateInput ? new Date(dateInput) : new Date();
            
            transactions.unshift({
                id: Date.now(),
                merchant,
                amount,
                category,
                date: transactionDate.toISOString(),
                type: currentTransactionType
            });
            
            if (isIncome) {
                savings += amount;
                updateSavingsDisplay();
            } else {
                savings -= amount;
                updateSavingsDisplay();
                budgetSpent += amount;
                updateBudgetDisplay();
                updateDailySpending();
                
                // Check if this expense breaches daily limit
                if (savingsGoal.dailyLimit > 0) {
                    const today = new Date().toDateString();
                    const spentToday = transactions
                        .filter(t => t.type === 'expense' && new Date(t.date).toDateString() === today)
                        .reduce((sum, t) => sum + t.amount, 0);
                    
                    if (spentToday > savingsGoal.dailyLimit && spentToday - amount <= savingsGoal.dailyLimit) {
                        showNotification('Daily Limit Exceeded!', `You've spent $${spentToday.toFixed(2)} today. Limit was $${savingsGoal.dailyLimit.toFixed(0)}`, 'error');
                    }
                }
            }
            
            updateTransactionsUI();
            updateChartWithData();
            generateSmartInsights();
            
            if (transactions.length === 1) {
                updateStreak();
                createConfetti();
                showNotification('First Step!', 'You\'ve started your savings journey!', 'success');
            } else {
                showNotification('Success', 'Transaction added!', 'success');
            }
            
            document.getElementById('transaction-amount').value = '';
            initDatePicker();
        }

        function updateTransactionsUI() {
            const container = document.getElementById('recent-activity');
            if (transactions.length === 0) {
                container.innerHTML = `
                    <div class="empty-state py-8">
                        <i class="fas fa-receipt text-gray-600"></i>
                        <p class="text-sm text-gray-500">No transactions yet</p>
                    </div>
                `;
                return;
            }
            
            const categoryIcons = {
                food: 'fa-coffee',
                shopping: 'fa-shopping-bag',
                transport: 'fa-bus',
                entertainment: 'fa-film',
                bills: 'fa-bolt',
                others: 'fa-receipt'
            };
            
            const categoryColors = {
                food: 'rose',
                shopping: 'blue',
                transport: 'emerald',
                entertainment: 'purple',
                bills: 'yellow',
                others: 'gray'
            };
            
            container.innerHTML = transactions.slice(0, 5).map(t => {
                const color = categoryColors[t.category];
                const icon = categoryIcons[t.category];
                const date = new Date(t.date);
                const dateStr = date.toLocaleDateString('en-US', { month: 'short', day: 'numeric' });
                
                return `
                    <div class="flex items-center justify-between p-3 rounded-lg bg-gray-800/50 hover:bg-gray-800 transition-colors slide-in">
                        <div class="flex items-center gap-3">
                            <div class="w-10 h-10 rounded-full bg-${color}-500/20 flex items-center justify-center">
                                <i class="fas ${icon} text-${color}-400"></i>
                            </div>
                            <div>
                                <p class="font-semibold text-sm">${t.merchant}</p>
                                <p class="text-xs text-gray-500">${dateStr} ‚Ä¢ <span class="text-${color}-400 capitalize">${t.category}</span></p>
                            </div>
                        </div>
                        <span class="${t.type === 'income' ? 'text-emerald-400' : 'text-rose-400'} font-bold">${t.type === 'income' ? '+' : '-'}$${t.amount.toFixed(2)}</span>
                    </div>
                `;
            }).join('');
        }

        function updateStreak() {
            streakCount = 1;
            document.getElementById('streak-count').textContent = streakCount;
            document.getElementById('streak-display').textContent = `${streakCount} Day Streak`;
            const fireIcon = document.querySelector('.fa-fire');
            if (fireIcon) {
                fireIcon.classList.remove('opacity-30');
                fireIcon.classList.add('streak-flame', 'text-orange-500');
            }
        }

        function showNotification(title, message, type = 'success') {
            const notif = document.getElementById('notification');
            const notifTitle = document.getElementById('notif-title');
            const notifMessage = document.getElementById('notif-message');
            
            const colors = {
                success: 'emerald',
                error: 'rose',
                info: 'blue',
                warning: 'yellow'
            };
            
            const color = colors[type] || 'emerald';
            notif.querySelector('.glass').className = `glass rounded-xl p-4 border border-${color}-500/30 flex items-center gap-3 notification bg-slate-900`;
            notif.querySelector('i').className = `fas fa-${type === 'success' ? 'check' : type === 'error' ? 'exclamation-circle' : type === 'warning' ? 'exclamation-triangle' : 'info'} text-${color}-400`;
            notifTitle.className = `font-bold text-${color}-400`;
            
            notifTitle.textContent = title;
            notifMessage.textContent = message;
            
            notif.classList.remove('hidden');
            setTimeout(() => notif.classList.add('hidden'), type === 'error' ? 5000 : 3000);
        }

        // Load
        window.addEventListener('load', () => {
            const saved = localStorage.getItem('smartsave_user');
            if (saved) {
                currentUser = JSON.parse(saved);
                document.getElementById('demo-background').style.display = 'none';
                document.getElementById('auth-modal').style.display = 'none';
                document.getElementById('main-content').classList.remove('hidden');
                document.getElementById('main-nav').classList.remove('hidden');
                document.getElementById('display-name').textContent = currentUser.name;
                document.getElementById('user-initial').textContent = currentUser.name[0].toUpperCase();
                initDatePicker();
            }
        });
    </script>
</body>
</html>